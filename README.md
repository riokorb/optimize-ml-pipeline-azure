# Optimizing an ML Pipeline in Azure

## Overview
This project is part of the Udacity Azure ML Nanodegree.
In this project, we build and optimize an Azure ML pipeline using the Python SDK and a provided Scikit-learn model.
This model is then compared to an Azure AutoML run.

## Summary
This dataset contains data about the personal and financial details of customers in a Portugese bank. Based on the dataset, we seek to predict if the customer will subscribe to bank term deposit.

The best performing model was a Soft Voting Ensemble found using AutoML, using XGBoost Classifier with a standard scaler wrapper."

## Scikit-learn Pipeline
**Explain the pipeline architecture, including data, hyperparameter tuning, and classification algorithm.**
First, we retrieve the dataset from the given url using AzureDataFactory class.

The data is then cleaned using clean_data function that we have defined, which includes preprocessing steps like converting categorical variables to binary encoding, one hot encoding etc.

The dataset is then split in the ratio of 70:30 for training and testing respectively.

Next, we set up a parameter sampler and define 2 hyperparameters to be tuned, namely C and max_iter. C represents the inverse regularization parameter and max_iter represents the maximum number of iterations.

A HyperDrive Config is created using a SKLearn estimator and the parameter sampler.

The accuracy is calculated on the test set for each run and the model corresponding to the best run with HyperDrive is saved.

**What are the benefits of the parameter sampler you chose?**
By using Random Parameter Sampling in our parameter sampler, we are performing random sampling over the hyperparameter search space.

This drastically reduces our computation time, and still able to find reasonably good models to other, more rigorous hyperparameter optimization methods.

**What are the benefits of the early stopping policy you chose?**
By setting up the early stopping policy in our HyperDriveConfig, we can stop unproductive runs where the accuracy of the model is not improving beyond a pre-defined tolerable level for a given number of iterations.

Additionally, it helps to reduce the computation time and relieve computation resources during the runs.

## AutoML
**In 1-2 sentences, describe the model and hyperparameters generated by AutoML.**
AutoML was capable of testing out many different models in a short period of time.
Examples include BoostedTrees, LightGBM, RandomForests, SGDClassifier and XGBoost.

The full list of models tested using AutoML is listed below:

![alt text](https://github.com/riokorb/optimize-ml-pipeline-azure/blob/master/automlmodels.PNG?raw=true)

## Pipeline comparison
**Compare the two models and their performance. What are the differences in accuracy? In architecture? If there was a difference, why do you think there was one?**
AutoML and HyperDrive achieved 0.XXX and 0.YYY in terms of accuracy respectively, which is not a significant difference.

AutoML definitely fared better in terms of architecture as it was able to try several models, which would require huge amounts of effort to be performed via HyperDrive (because a pipeline must be created for every model).

The difference could be because of the sheer ability of AutoML to compute a large number of models, some of which are very complex, in order to get the best results. 

## Future work
**What are some areas of improvement for future experiments? Why might these improvements help the model?**
The accuracy of AutoML might be affected by imbalanced data (since some class imbalances were observed), which can lead to a falsely perceived positive effect of a model's accuracy, because the input data is biased towards a certain class.

We can revisit the sampling methods and consider custom cross-validation strategies to try and mitigate the impact of imbalanced data on performance metrics.

## Proof of cluster clean up
**If you did not delete your compute cluster in the code, please complete this section. Otherwise, delete this section.**
**Image of cluster marked for deletion**

![alt text](https://github.com/riokorb/optimize-ml-pipeline-azure/blob/master/clusterdelete.PNG?raw=true)

